{% extends 'core/base.html' %}

{% block title %}My Profile - Data Detective{% endblock %}

{% block content %}
<div class="container mx-auto px-6 py-12">
    <div class="glass p-8 md:p-12 rounded-3xl w-full max-w-2xl mx-auto relative overflow-hidden animate-fade-in-up">

        <h1 class="text-3xl font-bold font-heading mb-8 text-center">Detective Profile</h1>

        <div class="flex flex-col items-center gap-6 mb-10">
            <div class="relative group">
                <div
                    class="w-32 h-32 rounded-full overflow-hidden border-4 border-cyan-500 shadow-[0_0_30px_rgba(6,182,212,0.5)]">
                    {% if user.profile.avatar %}
                    <img src="{{ user.profile.avatar.url }}" alt="Avatar" class="w-full h-full object-cover">
                    {% else %}
                    {% load static %}
                    <img src="{% static 'core/images/default_avatar.png' %}" alt="Default Avatar"
                        class="w-full h-full object-cover opacity-80">
                    {% endif %}
                </div>
                <!-- Upload Overlay -->
                <label for="avatar_upload"
                    class="absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer rounded-full">
                    <span class="text-xs font-bold text-white uppercase tracking-wider">Change</span>
                </label>
            </div>

            <div class="text-center">
                <h2 class="text-2xl font-bold text-white">{{ user.username }}</h2>
                <div class="text-cyan-400 font-bold">Level {{ user.profile.level }} Analyst</div>
                <div class="text-slate-400 text-sm">{{ user.email }}</div>
            </div>
        </div>

        <form method="post" enctype="multipart/form-data" id="avatar_form" class="hidden">
            {% csrf_token %}
            <input type="file" name="avatar" id="avatar_upload" accept="image/*"
                onchange="document.getElementById('avatar_form').submit();">
        </form>

        <div class="grid grid-cols-2 gap-4 mb-8">
            <div class="bg-slate-800/50 p-4 rounded-xl text-center border border-white/5">
                <div class="text-slate-400 text-xs uppercase tracking-wider mb-1">Total XP</div>
                <div class="text-xl font-bold text-yellow-400">{{ user.profile.xp }}</div>
            </div>
            <div class="bg-slate-800/50 p-4 rounded-xl text-center border border-white/5">
                <div class="text-slate-400 text-xs uppercase tracking-wider mb-1">Joined</div>
                <div class="text-xl font-bold text-white">{{ user.date_joined|date:"M Y" }}</div>
            </div>
        </div>

        <div class="space-y-4">
            <a href="/logout"
                class="block w-full py-3 rounded-xl bg-slate-800 hover:bg-slate-700 text-slate-300 text-center font-bold transition-colors">
                Log Out
            </a>
            {% if user.is_staff %}
            <a href="/admin-dashboard"
                class="block w-full py-3 rounded-xl bg-purple-600 hover:bg-purple-500 text-white text-center font-bold transition-colors shadow-lg shadow-purple-600/20">
                Access Admin Dashboard üõ°Ô∏è
            </a>
            {% endif %}
        </div>

    </div>
</div>
{% endblock %}